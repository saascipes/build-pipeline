{"jobDefs":[{"version":"0.0","name":"Init Build Pipeline Demo","maxInstances":1,"pauseOnJobFail":false,"runtimeVars":{"ECR_REPO_URI":"*","GIT_PASSWORD":"*","instances":"*","GIT_URL":"*","GIT_USERNAME":"*","GIT_REPO_NAME":"*"},"schedules":[],"taskDefs":[{"target":4,"name":"Duplicate git repo","requiredTags":{"terraform":"true"},"fromRoutes":[],"toRoutes":[],"autoRestart":false,"stepDefs":[{"name":"run","order":1,"command":"","arguments":"","variables":{},"lambdaCodeSource":"script","lambdaRuntime":"","lambdaMemorySize":128,"lambdaTimeout":3,"lambdaFunctionHandler":"","lambdaAWSRegion":"","lambdaDependencies":"","lambdaZipfile":"","scriptName":"DuplicateGitRepo.sh"}],"exportWarnings":[]},{"target":4,"name":"Create eks cluster","requiredTags":{"terraform":"true"},"fromRoutes":[["Duplicate git repo",".*"]],"toRoutes":[],"autoRestart":false,"stepDefs":[{"name":"run","order":2,"command":"","arguments":"","variables":{},"lambdaCodeSource":"script","lambdaRuntime":"","lambdaMemorySize":128,"lambdaTimeout":3,"lambdaFunctionHandler":"","lambdaAWSRegion":"","lambdaDependencies":"","lambdaZipfile":"","scriptName":"CreateBuildPipelineDemoEKSCluster.sh"}],"exportWarnings":[]},{"target":32,"name":"Start ec2 instance","requiredTags":{},"fromRoutes":[],"toRoutes":[],"autoRestart":false,"stepDefs":[{"name":"AwsLambda","order":1,"command":"","arguments":"","variables":{},"lambdaCodeSource":"script","lambdaRuntime":"python2.7","lambdaMemorySize":128,"lambdaTimeout":15,"lambdaFunctionHandler":"","lambdaAWSRegion":"","lambdaDependencies":"boto3","lambdaZipfile":"","scriptName":"StartEC2Instance.py"}],"exportWarnings":[]}]},{"version":"0.0","name":"Build Stock Quotes Publisher","maxInstances":1,"pauseOnJobFail":false,"runtimeVars":{"ECR_REPO_URI":"*","GIT_REPO_NAME":"*","docker_tag":"*"},"schedules":[],"taskDefs":[{"target":4,"name":"Deploy build environment","requiredTags":{"terraform":"true"},"fromRoutes":[],"toRoutes":[],"autoRestart":false,"stepDefs":[{"name":"run","order":1,"command":"","arguments":"","variables":{},"lambdaCodeSource":"script","lambdaRuntime":"","lambdaMemorySize":128,"lambdaTimeout":3,"lambdaFunctionHandler":"","lambdaAWSRegion":"","lambdaDependencies":"","lambdaZipfile":"","scriptName":"DeployBuildPipelineDemoBuildEnvironment.sh"}],"exportWarnings":[]},{"target":4,"name":"Run build","requiredTags":{"demo":"build-pipeline-1"},"fromRoutes":[["Deploy build environment",""]],"toRoutes":[],"autoRestart":false,"stepDefs":[{"name":"run","order":1,"command":"","arguments":"","variables":{"NODE_ENV":"test"},"lambdaCodeSource":"script","lambdaRuntime":"","lambdaMemorySize":128,"lambdaTimeout":3,"lambdaFunctionHandler":"","lambdaAWSRegion":"","lambdaDependencies":"","lambdaZipfile":"","scriptName":"BuildStockQuotePublisher.sh"}],"exportWarnings":[]},{"target":4,"name":"Deploy build","requiredTags":{"terraform":"true"},"fromRoutes":[["Run build","ok"]],"toRoutes":[],"autoRestart":false,"stepDefs":[{"name":"run","order":1,"command":"","arguments":"@sgg(\"docker_tag\")","variables":{},"lambdaCodeSource":"script","lambdaRuntime":"","lambdaMemorySize":128,"lambdaTimeout":3,"lambdaFunctionHandler":"","lambdaAWSRegion":"","lambdaDependencies":"","lambdaZipfile":"","scriptName":"DeployStockQuotePublisherDemo.sh"}],"exportWarnings":[]}]},{"version":"0.0","name":"Remove Build Pipeline Demo","maxInstances":1,"misFireGraceTime":null,"coalesce":null,"pauseOnJobFail":false,"runtimeVars":{"GIT_PASSWORD":"*","docker_tag":"*","instances":"*","GIT_URL":"*","GIT_USERNAME":"*","GIT_REPO_NAME":"*"},"schedules":[],"taskDefs":[{"target":4,"name":"Delete git repo","order":null,"requiredTags":{"ec2admin":"true"},"fromRoutes":[],"toRoutes":[],"autoRestart":false,"stepDefs":[{"name":"run","order":1,"command":"","arguments":"","variables":{},"lambdaCodeSource":"script","lambdaRuntime":"","lambdaMemorySize":128,"lambdaTimeout":3,"lambdaFunctionHandler":"","lambdaAWSRegion":"","lambdaDependencies":"","lambdaZipfile":"","scriptName":"DeleteGitRepo.sh"}],"exportWarnings":[]},{"target":4,"name":"Delete eks cluster","order":null,"requiredTags":{"terraform":"true"},"fromRoutes":[],"toRoutes":[],"autoRestart":false,"stepDefs":[{"name":"run","order":2,"command":"","arguments":"","variables":{},"lambdaCodeSource":"script","lambdaRuntime":"","lambdaMemorySize":128,"lambdaTimeout":3,"lambdaFunctionHandler":"","lambdaAWSRegion":"","lambdaDependencies":"","lambdaZipfile":"","scriptName":"RemoveBuildPipelineDemoEKSCluster"}],"exportWarnings":[]},{"target":32,"name":"Stop ec2 instance","order":null,"requiredTags":{},"fromRoutes":[["Delete eks cluster",".*"]],"toRoutes":[],"autoRestart":false,"stepDefs":[{"name":"AwsLambda","order":1,"command":"","arguments":"","variables":{},"lambdaCodeSource":"script","lambdaRuntime":"python2.7","lambdaMemorySize":128,"lambdaTimeout":30,"lambdaFunctionHandler":"","lambdaAWSRegion":"","lambdaDependencies":"","lambdaZipfile":"","scriptName":"StopEC2Instance.py"}],"exportWarnings":[]}]},{"version":"0.0","name":"SPA Build Pipeline Init AWS","maxInstances":1,"pauseOnJobFail":false,"runtimeVars":{"TERRAFORM_VERSION":"*","workingdir":"*","tags":"*","sgTeamId":"*","sgLoginUrl":"*","sgApiUrl":"*","agentDownloadAccessKeySecret":"*","agentDownloadAccessKeyId":"*","agentAccessKeySecret":"*","agentAccessKeyId":"*","VpcId":"*","SubnetId":"*","SecurityGroupIds":"*","NumInstances":"*","KeyName":"*","InstanceType":"*","IAMRole":"*","ImageId":"*"},"schedules":[],"taskDefs":[{"target":32,"name":"Create EC2 instance","requiredTags":{},"fromRoutes":[],"toRoutes":[],"autoRestart":false,"stepDefs":[{"name":"AwsLambda","order":1,"command":"","arguments":"","variables":{},"lambdaCodeSource":"script","lambdaRuntime":"python2.7","lambdaMemorySize":128,"lambdaTimeout":60,"lambdaFunctionHandler":"","lambdaAWSRegion":"","lambdaDependencies":"boto3;requests","lambdaZipfile":"","scriptName":"CreateEC2Instance.py"}],"exportWarnings":[]},{"target":8,"name":"Configure EC2 instance","requiredTags":{"terraform":"true"},"fromRoutes":[["Create EC2 instance",""]],"toRoutes":[],"autoRestart":false,"stepDefs":[{"name":"install terraform","order":1,"command":"","arguments":"","variables":{},"lambdaCodeSource":"script","lambdaRuntime":"","lambdaMemorySize":128,"lambdaTimeout":3,"lambdaFunctionHandler":"","lambdaAWSRegion":"","lambdaDependencies":"","lambdaZipfile":"","scriptName":"ConfigureTerraform_AMZN_Linux_2.sh"},{"name":"install git","order":2,"command":"","arguments":"","variables":{},"lambdaCodeSource":"script","lambdaRuntime":"","lambdaMemorySize":128,"lambdaTimeout":3,"lambdaFunctionHandler":"","lambdaAWSRegion":"","lambdaDependencies":"","lambdaZipfile":"","scriptName":"install git on ec2"},{"name":"install aws cli","order":3,"command":"","arguments":"","variables":{},"lambdaCodeSource":"script","lambdaRuntime":"","lambdaMemorySize":128,"lambdaTimeout":3,"lambdaFunctionHandler":"","lambdaAWSRegion":"","lambdaDependencies":"","lambdaZipfile":"","scriptName":"InstallAWSSDK.sh"}],"exportWarnings":[]},{"target":4,"name":"Create ECR Repositories","requiredTags":{"terraform":"true"},"fromRoutes":[["Configure EC2 instance",""]],"toRoutes":[],"autoRestart":false,"stepDefs":[{"name":"run","order":2,"command":"","arguments":"","variables":{},"lambdaCodeSource":"script","lambdaRuntime":"","lambdaMemorySize":128,"lambdaTimeout":3,"lambdaFunctionHandler":"","lambdaAWSRegion":"","lambdaDependencies":"","lambdaZipfile":"","scriptName":"CreateSPABuildPipelineECRRepos.py"},{"name":"install prerequisites","order":1,"command":"","arguments":"","variables":{},"lambdaCodeSource":"script","lambdaRuntime":"","lambdaMemorySize":128,"lambdaTimeout":3,"lambdaFunctionHandler":"","lambdaAWSRegion":"","lambdaDependencies":"","lambdaZipfile":"","scriptName":"InstallBoto3.sh"}],"exportWarnings":[]}]}],"scripts":[{"name":"DuplicateGitRepo.sh","scriptType":2,"code":"UkFORF9TVFJJTkc9JChvcGVuc3NsIHJhbmQgLWhleCA2KQplY2hvICJAc2dveyJuZXdfcmVwb19pZCI6IFwiJFJBTkRfU1RSSU5HXCJ9IgojIGVjaG8gJ0BzZ297XCJnaXRfcmVwb19pZFwiLCAiJFJBTkRfU1RSSU5HIn0nCmN1cmwgLUggJ0F1dGhvcml6YXRpb246IHRva2VuIEBzZ2coIkdJVF9QQVNTV09SRCIpJyAtLWRhdGEgIntcIm5hbWVcIjpcIkBzZ2coIkdJVF9SRVBPX05BTUUiKS0kUkFORF9TVFJJTkdcIiwgXCJwcml2YXRlXCI6IHRydWV9IiBodHRwczovL2FwaS5naXRodWIuY29tL3VzZXIvcmVwb3MKZ2l0IGNsb25lIC0tYmFyZSBodHRwczovL0BzZ2coR0lUX1VTRVJOQU1FKTpAc2dnKEdJVF9QQVNTV09SRClAQHNnZyhHSVRfVVJMKS9Ac2dnKEdJVF9SRVBPX05BTUUpLmdpdApjZCBAc2dnKEdJVF9SRVBPX05BTUUpLmdpdApnaXQgcHVzaCAtLW1pcnJvciAiaHR0cHM6Ly9Ac2dnKCJHSVRfVVNFUk5BTUUiKTpAc2dnKCJHSVRfUEFTU1dPUkQiKUBAc2dnKCJHSVRfVVJMIikvQHNnZygiR0lUX1JFUE9fTkFNRSIpLSRSQU5EX1NUUklORy5naXQi","teamUsable":true,"teamEditable":false,"isActive":true},{"name":"CreateBuildPipelineDemoEKSCluster.sh","scriptType":2,"code":"Y2QgfgoKZ2l0IGNsb25lIGh0dHBzOi8vQHNnZygiR0lUX1VTRVJOQU1FIik6QHNnZygiR0lUX1BBU1NXT1JEIilAZ2l0aHViLmNvbS9Ac2dnKCJHSVRfVVNFUk5BTUUiKS9Ac2dnKCJHSVRfUkVQT19OQU1FIiktQHNnZygibmV3X3JlcG9faWQiKS5naXQKCmNkIEBzZ2coIkdJVF9SRVBPX05BTUUiKS1Ac2dnKCJuZXdfcmVwb19pZCIpL2RlcGxveS90ZXJyYWZvcm0vcHJvdmlzaW9uLwp0ZXJyYWZvcm0gaW5pdAp0ZXJyYWZvcm0gYXBwbHkgLWF1dG8tYXBwcm92ZQoKY2QgLi4vZGVwbG95LXByb2QvCnRlcnJhZm9ybSBpbml0CnRlcnJhZm9ybSBhcHBseSAtdmFyPSJlbnZpcm9ubWVudD1wcm9kIiAtdmFyPSJzdG9ja19wdWJsaXNoZXJfdmVyc2lvbj12MC4xIiAtdmFyPSJkZW1vX2lkPUBzZ2cobmV3X3JlcG9faWQpIiAtdmFyPSJlY3J1cmk9QHNnZyhFQ1JfUkVQT19VUkkpIiAtYXV0by1hcHByb3ZlCg==","teamUsable":true,"teamEditable":false,"isActive":true},{"name":"StartEC2Instance.py","scriptType":0,"code":"aW1wb3J0IGJvdG8zCgpyZWdpb24gPSAnQHNnZygiQVdTX1JFR0lPTiIpJwppbnN0YW5jZXMgPSAnQHNnZygiaW5zdGFuY2VzIiknLnNwbGl0KCcsJykKaW5zdGFuY2VzID0gbGlzdChtYXAobGFtYmRhIHg6IHguc3RyaXAoKSwgaW5zdGFuY2VzKSkKZWMyID0gYm90bzMuY2xpZW50KCdlYzInLCByZWdpb25fbmFtZT1yZWdpb24sIGF3c19hY2Nlc3Nfa2V5X2lkPSdAc2dnKCJBV1NfQUNDRVNTX0tFWV9JRCIpJywgYXdzX3NlY3JldF9hY2Nlc3Nfa2V5PSdAc2dnKCJBV1NfU0VDUkVUX0FDQ0VTU19LRVkiKScpCmVjMi5zdGFydF9pbnN0YW5jZXMoSW5zdGFuY2VJZHM9aW5zdGFuY2VzKQpwcmludCgnc3RhcnRlZCBpbnN0YW5jZXM6ICcgKyBzdHIoaW5zdGFuY2VzKSkK","teamUsable":true,"teamEditable":true,"isActive":true},{"name":"DeployBuildPipelineDemoBuildEnvironment.sh","scriptType":2,"code":"c2V0IC1lCgpyZXBvX25hbWU9J0BzZ2coInJlcG9fbmFtZSIpJwoKIyBTZXQgZGFzaCBhcyBkZWxpbWl0ZXIKSUZTPSctJwojUmVhZCB0aGUgc3BsaXQgd29yZHMgaW50byBhbiBhcnJheSBiYXNlZCBvbiBjb21tYSBkZWxpbWl0ZXIKcmVhZCAtYSBzdHJhcnIgPDw8ICIkcmVwb19uYW1lIgpsZW49JHsjc3RyYXJyW0BdfQpuZXdfcmVwb19pZD0ke3N0cmFyclskbGVuLTFdfQoKZWNobyAiQHNnb3snbmV3X3JlcG9faWQnOicke25ld19yZXBvX2lkfSd9IgoKY2Qgfi9Ac2dnKEdJVF9SRVBPX05BTUUpLSR7bmV3X3JlcG9faWR9L2RlcGxveS90ZXJyYWZvcm0vZGVwbG95LXRlc3QvCnRlcnJhZm9ybSBpbml0CnRlcnJhZm9ybSBhcHBseSAtdmFyPSJzZ19hZ2VudF92ZXJzaW9uPXYwLjEiIC12YXI9ImRlbW9faWQ9JHtuZXdfcmVwb19pZH0iIC12YXI9ImVjcnVyaT1Ac2dnKEVDUl9SRVBPX1VSSSkiIC1hdXRvLWFwcHJvdmUK","teamUsable":true,"teamEditable":false,"isActive":true},{"name":"BuildStockQuotePublisher.sh","scriptType":2,"code":"c2V0IC1lCgpleHBvcnQgTk9ERV9DT05GSUdfRElSPS9Ac2dnKEdJVF9SRVBPX05BTUUpLUBzZ2coIm5ld19yZXBvX2lkIikvY29uZmlnLwpjZCAvCmdpdCBjbG9uZSBodHRwczovL0BzZ2coIlNHX0dJVF9TRUNSRVQiKUBnaXRodWIuY29tL3NhYXNnbHVlL0BzZ2coR0lUX1JFUE9fTkFNRSktQHNnZygibmV3X3JlcG9faWQiKS5naXQKY2QgQHNnZyhHSVRfUkVQT19OQU1FKS1Ac2dnKCJuZXdfcmVwb19pZCIpCm5wbSBpIC0tdW5zYWZlLXBlcm0KCmVjaG8gIkBzZ297J3JvdXRlJzonb2snfSI=","teamUsable":true,"teamEditable":false,"isActive":true},{"name":"DeployStockQuotePublisherDemo.sh","scriptType":2,"code":"Y2Qgfi9Ac2dnKEdJVF9SRVBPX05BTUUpLUBzZ2coIm5ld19yZXBvX2lkIikvCgpnaXQgcHVsbAoKYXdzIGVjciBnZXQtbG9naW4tcGFzc3dvcmQgLS1yZWdpb24gdXMtZWFzdC0xIHwgZG9ja2VyIGxvZ2luIC0tdXNlcm5hbWUgQVdTIC0tcGFzc3dvcmQtc3RkaW4gQHNnZyhFQ1JfUkVQT19VUkkpCgpzdWRvIHNlcnZpY2UgZG9ja2VyIHN0YXJ0Cgpkb2NrZXIgYnVpbGQgLWYgZGVwbG95L2RvY2tlci9zdG9ja19xdW90ZV9wdWJsaXNoZXIvRG9ja2VyZmlsZSAtdCBzdG9ja19xdW90ZV9wdWJsaXNoZXIgLgpkb2NrZXIgdGFnIHN0b2NrX3F1b3RlX3B1Ymxpc2hlciBAc2dnKEVDUl9SRVBPX1VSSSkvc2dfZGVtb19zdG9ja19xdW90ZV9wdWJsaXNoZXI6JDEKZG9ja2VyIHB1c2ggQHNnZyhFQ1JfUkVQT19VUkkpL3NnX2RlbW9fc3RvY2tfcXVvdGVfcHVibGlzaGVyOiQxCmRvY2tlciB0YWcgc3RvY2tfcXVvdGVfcHVibGlzaGVyIEBzZ2coRUNSX1JFUE9fVVJJKS9zZ19kZW1vX3N0b2NrX3F1b3RlX3B1Ymxpc2hlcjpsYXRlc3QKZG9ja2VyIHB1c2ggQHNnZyhFQ1JfUkVQT19VUkkpL3NnX2RlbW9fc3RvY2tfcXVvdGVfcHVibGlzaGVyOmxhdGVzdAoKY2QgZGVwbG95L3RlcnJhZm9ybS9kZXBsb3ktcHJvZC8KCnRlcnJhZm9ybSBhcHBseSAtdmFyPSJlbnZpcm9ubWVudD1wcm9kIiAtdmFyPSJzdG9ja19wdWJsaXNoZXJfdmVyc2lvbj1Ac2dnKCJkb2NrZXJfdGFnIikiIC12YXI9ImRlbW9faWQ9QHNnZyhuZXdfcmVwb19pZCkiIC12YXI9ImVjcnVyaT1Ac2dnKEVDUl9SRVBPX1VSSSkiIC1hdXRvLWFwcHJvdmUK","teamUsable":true,"teamEditable":false,"isActive":true},{"name":"DeleteGitRepo.sh","scriptType":2,"code":"Y3VybCAtWCBERUxFVEUgLUggJ0F1dGhvcml6YXRpb246IHRva2VuIEBzZ2coIkdJVF9QQVNTV09SRCIpJyBodHRwczovL2FwaS5naXRodWIuY29tL3JlcG9zL0BzZ2coR0lUX1VTRVJOQU1FKS9Ac2dnKCJHSVRfUkVQT19OQU1FIiktQHNnZygiZGVtb19pZCIpCg==","teamUsable":true,"teamEditable":false,"isActive":true},{"name":"RemoveBuildPipelineDemoEKSCluster","scriptType":2,"code":"Y2Qgfi9Ac2dnKEdJVF9SRVBPX05BTUUpLUBzZ2coImRlbW9faWQiKS9kZXBsb3kvdGVycmFmb3JtL2RlcGxveS10ZXN0Lwp0ZXJyYWZvcm0gZGVzdHJveSAtdmFyPSJzZ19hZ2VudF92ZXJzaW9uPXYwLjEiIC12YXI9ImRlbW9faWQ9QHNnZyhkZW1vX2lkKSIgLWF1dG8tYXBwcm92ZQoKY2QgLi4vZGVwbG95LXByb2QvCnRlcnJhZm9ybSBkZXN0cm95IC12YXI9ImVudmlyb25tZW50PXByb2QiIC12YXI9InN0b2NrX3B1Ymxpc2hlcl92ZXJzaW9uPUBzZ2coImRvY2tlcl90YWciKSIgLXZhcj0iZGVtb19pZD1Ac2dnKGRlbW9faWQpIiAtYXV0by1hcHByb3ZlCgpjZCAuLi9wcm92aXNpb24vCnRlcnJhZm9ybSBkZXN0cm95IC1hdXRvLWFwcHJvdmUKCmNkIH4Kc3VkbyBybSAtcmYgQHNnZyhHSVRfUkVQT19OQU1FKS1Ac2dnKCJkZW1vX2lkIikv","teamUsable":true,"teamEditable":false,"isActive":true},{"name":"StopEC2Instance.py","scriptType":0,"code":"aW1wb3J0IGJvdG8zCgpyZWdpb24gPSAnQHNnZygiQVdTX1JFR0lPTiIpJwppbnN0YW5jZXMgPSAnQHNnZygiaW5zdGFuY2VzIiknLnNwbGl0KCcsJykKaW5zdGFuY2VzID0gbGlzdChtYXAobGFtYmRhIHg6IHguc3RyaXAoKSwgaW5zdGFuY2VzKSkKZWMyID0gYm90bzMuY2xpZW50KCdlYzInLCByZWdpb25fbmFtZT1yZWdpb24sIGF3c19hY2Nlc3Nfa2V5X2lkPSdAc2dnKCJBV1NfQUNDRVNTX0tFWV9JRCIpJywgYXdzX3NlY3JldF9hY2Nlc3Nfa2V5PSdAc2dnKCJBV1NfU0VDUkVUX0FDQ0VTU19LRVkiKScpCmVjMi5zdG9wX2luc3RhbmNlcyhJbnN0YW5jZUlkcz1pbnN0YW5jZXMpCnByaW50KCdzdG9wcGVkIGluc3RhbmNlczogJyArIHN0cihpbnN0YW5jZXMpKQo=","teamUsable":true,"teamEditable":false,"isActive":true},{"name":"CreateEC2Instance.py","scriptType":0,"code":"aW1wb3J0IGJhc2U2NAppbXBvcnQgc3lzCmltcG9ydCBvcwpmcm9tIG9zIGltcG9ydCBwYXRoCmltcG9ydCByZXF1ZXN0cwppbXBvcnQganNvbgpmcm9tIGRhdGV0aW1lIGltcG9ydCBkYXRldGltZQppbXBvcnQgdGltZQppbXBvcnQgbWF0aAoKQHNncygiZWMyX2FjY2Vzcy5weSIpCgoKZGVmIENyZWF0ZUVDMkluc3RhbmNlcyh0YWdzLCBjb3VudCk6CiAgICBkYXRhID0gIiIiIyEvdXNyL2Jpbi9weXRob24KaW1wb3J0IHN5cwppbXBvcnQgb3MKaW1wb3J0IHJlcXVlc3RzCmltcG9ydCBqc29uCmltcG9ydCBnemlwCmltcG9ydCBzaHV0aWwKaW1wb3J0IHRpbWUKCgp0b2tlbiA9ICcnCgoKdGVhbUlkID0gW3RlYW1JZF0KYWNjZXNzS2V5SWQgPSBbYWNjZXNzS2V5SWRdCmFjY2Vzc0tleVNlY3JldCA9IFthY2Nlc3NLZXlTZWNyZXRdCndvcmtpbmdkaXIgPSBbd29ya2luZ2Rpcl0KcGxhdGZvcm0gPSBbcGxhdGZvcm1dCmFyY2ggPSBbYXJjaF0KY29uZmlnID0gW2NvbmZpZ10KbG9naW51cmwgPSBbbG9naW51cmxdCmFwaXVybCA9IFthcGl1cmxdCgp0cnk6CiAgICBvcy5ta2Rpcih3b3JraW5nZGlyKQpleGNlcHQgKE9TRXJyb3IpIGFzIGVycjoKICAgIHBhc3MKCm91dEZpbGUgPSAne30vc2ctYWdlbnQtbGF1bmNoZXInLmZvcm1hdCh3b3JraW5nZGlyKQoKCmRlZiBSZXN0QVBJTG9naW4oKToKICAgIGdsb2JhbCB0b2tlbgogICAgZ2xvYmFsIHRlYW1JZAogICAgZ2xvYmFsIGFjY2Vzc0tleUlkCiAgICBnbG9iYWwgYWNjZXNzS2V5U2VjcmV0CgogICAgdXJsID0gJ2h0dHBzOi8vY29uc29sZS5zYWFzZ2x1ZS5jb20vbG9naW4vYXBpbG9naW4nCiAgICAKICAgIGhlYWRlcnMgPSB7CiAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJwogICAgfQoKICAgIGRhdGEgPSB7CiAgICAgICAgJ2FjY2Vzc0tleUlkJzogYWNjZXNzS2V5SWQsCiAgICAgICAgJ2FjY2Vzc0tleVNlY3JldCc6IGFjY2Vzc0tleVNlY3JldAogICAgfQoKICAgIHJlcyA9IHJlcXVlc3RzLnBvc3QodXJsPXVybCwgaGVhZGVycz1oZWFkZXJzLCBkYXRhPWpzb24uZHVtcHMoZGF0YSkpCiAgICBpZiAocmVzLnN0YXR1c19jb2RlICE9IDIwMCk6CiAgICAgICAgcmFpc2UgRXhjZXB0aW9uKAogICAgICAgICAgICAnQ2FsbCB0byB7fSByZXR1cm5lZCB7fSAtIHt9Jy5mb3JtYXQodXJsLCByZXMuc3RhdHVzX2NvZGUsIHJlcy50ZXh0KSkKCiAgICB0b2tlbiA9IGpzb24ubG9hZHMocmVzLnRleHQpWydjb25maWcxJ10KICAgIHRlYW1JZCA9IGpzb24ubG9hZHMocmVzLnRleHQpWydjb25maWczJ10KCgpkZWYgR2V0RG93bmxvYWRVcmwoKToKICAgIGdsb2JhbCB0b2tlbgogICAgZ2xvYmFsIHRlYW1JZAogICAgZ2xvYmFsIHBsYXRmb3JtCiAgICBnbG9iYWwgYXJjaAoKICAgIHdoaWxlIHRva2VuID09ICcnOgogICAgICAgIFJlc3RBUElMb2dpbigpCiAgICAgICAgaWYgdG9rZW4gPT0gJyc6CiAgICAgICAgICAgIHByaW50KCdBUEkgbG9naW4gZmFpbGVkJykKICAgICAgICAgICAgdGltZS5zbGVlcCg1KQogICAgICAgICAgICBwcmludCgnUmV0cnlpbmcgYXBpIGxvZ2luJykKICAgIAogICAgdXJsID0gJ2h0dHBzOi8vY29uc29sZS5zYWFzZ2x1ZS5jb20vYXBpL3YwL2FnZW50RG93bmxvYWQvYWdlbnRzdHViL3t9Jy5mb3JtYXQocGxhdGZvcm0pCiAgICBpZiBhcmNoOgogICAgICAgIHVybCArPSAoJy8nICsgYXJjaCkKCiAgICBoZWFkZXJzID0gewogICAgCSdDb29raWUnOiAnQXV0aD17fTsnLmZvcm1hdCh0b2tlbiksCiAgICAgICAgJ190ZWFtSWQnOiB0ZWFtSWQKICAgIH0KCiAgICB3aGlsZSBUcnVlOgogICAgICAgIHJlcyA9IHJlcXVlc3RzLmdldCh1cmw9dXJsLCBoZWFkZXJzPWhlYWRlcnMpCgogICAgICAgIHByaW50KCdyZXMxID0gJywgcmVzLmpzb24oKSkKICAgICAgICBwcmludCgncmVzMiA9ICcsIHJlcy5qc29uKClbJ2RhdGEnXSkKICAgICAgICBpZiAocmVzLnN0YXR1c19jb2RlID09IDIwMCk6CiAgICAgICAgICAgIGJyZWFrCiAgICAgICAgZWxzZToKICAgICAgICAgICAgaWYgKHJlcy5zdGF0dXNfY29kZSA9PSAzMDMpOgogICAgICAgICAgICAgICAgdGltZS5zbGVlcCgxMCkKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHJhaXNlIEV4Y2VwdGlvbigKICAgICAgICAgICAgICAgICAgICAnQ2FsbCB0byB7fSByZXR1cm5lZCB7fSAtIHt9Jy5mb3JtYXQodXJsLCByZXMuc3RhdHVzX2NvZGUsIHJlcy50ZXh0KSkKCiAgICByZXR1cm4gcmVzLmpzb24oKVsnZGF0YSddCgoKZGVmIERvd25sb2FkQWdlbnQoKToKICAgIGdsb2JhbCBwbGF0Zm9ybQoKICAgIHMzdXJsID0gR2V0RG93bmxvYWRVcmwoKQoKICAgIHJlcyA9IHJlcXVlc3RzLmdldChzM3VybCwgYWxsb3dfcmVkaXJlY3RzPVRydWUpCgogICAgb3Blbignc2ctYWdlbnQtbGF1bmNoZXIuZ3onLCAnd2InKS53cml0ZShyZXMuY29udGVudCkKCiAgICB3aXRoIGd6aXAub3Blbignc2ctYWdlbnQtbGF1bmNoZXIuZ3onLCAncmInKSBhcyBmX2luOgogICAgICAgIHdpdGggb3BlbihvdXRGaWxlLCAnd2InKSBhcyBmX291dDoKICAgICAgICAgICAgc2h1dGlsLmNvcHlmaWxlb2JqKGZfaW4sIGZfb3V0KQogICAgICAgIG9zLmNobW9kKG91dEZpbGUsIDBvNzc3KQoKICAgIG9zLnJlbW92ZSgnc2ctYWdlbnQtbGF1bmNoZXIuZ3onKQoKCgpEb3dubG9hZEFnZW50KCkKCmNvbmZpZ0ZpbGUgPSAne30vc2cuY2ZnJy5mb3JtYXQod29ya2luZ2RpcikKd2l0aCBvcGVuKGNvbmZpZ0ZpbGUsICd3JykgYXMgZjoKICAgIGpzb24uZHVtcChjb25maWcsIGYsIGluZGVudD00KQpvcy5zeXN0ZW0oJ2Nob3duIGVjMi11c2VyOmVjMi11c2VyIHt9Jy5mb3JtYXQoY29uZmlnRmlsZSkpCgpvcy5jaGRpcih3b3JraW5nZGlyKQpvcy5zeXN0ZW0oJ3N1IC0gZWMyLXVzZXIgLWMge30nLmZvcm1hdChvdXRGaWxlKSkKIiIiCgogICAgZGF0YSA9IGRhdGEucmVwbGFjZSgnW3RlYW1JZF0nLCAnIkBzZ2coInNnVGVhbUlkIikiJykKICAgIGRhdGEgPSBkYXRhLnJlcGxhY2UoJ1thY2Nlc3NLZXlJZF0nLCAnIkBzZ2coImFnZW50RG93bmxvYWRBY2Nlc3NLZXlJZCIpIicpCiAgICBkYXRhID0gZGF0YS5yZXBsYWNlKCdbYWNjZXNzS2V5U2VjcmV0XScsICciQHNnZygiYWdlbnREb3dubG9hZEFjY2Vzc0tleVNlY3JldCIpIicpCiAgICBkYXRhID0gZGF0YS5yZXBsYWNlKCdbd29ya2luZ2Rpcl0nLCAnIkBzZ2coIndvcmtpbmdkaXIiKSInKQogICAgZGF0YSA9IGRhdGEucmVwbGFjZSgnW3BsYXRmb3JtXScsICcibGludXgiJykKICAgIGRhdGEgPSBkYXRhLnJlcGxhY2UoJ1thcmNoXScsICdOb25lJykKICAgIGRhdGEgPSBkYXRhLnJlcGxhY2UoJ1tsb2dpbnVybF0nLCAnIkBzZ2coInNnTG9naW5VcmwiKSInKQogICAgZGF0YSA9IGRhdGEucmVwbGFjZSgnW2FwaXVybF0nLCAnIkBzZ2coInNnQXBpVXJsIikiJykKICAgIGRhdGEgPSBkYXRhLnJlcGxhY2UoJ1tjb25maWddJywgJ3sidGFncyI6IEBzZ2coInRhZ3MiKSwgIlNHX0FDQ0VTU19LRVlfSUQiOiAiQHNnZygiYWdlbnRBY2Nlc3NLZXlJZCIpIiwgIlNHX0FDQ0VTU19LRVlfU0VDUkVUIjogIkBzZ2coImFnZW50QWNjZXNzS2V5U2VjcmV0IikiLCAicHJvcGVydHlPdmVycmlkZXMiOiB7Im1heEFjdGl2ZVRhc2tzIjogMn19JykKICAgIAogICAgIyBwcmludCAnXG4nICsgZGF0YSArICdcbicKCiAgICBkYXRhX2J5dGVzID0gZGF0YS5lbmNvZGUoJ3V0ZjgnKQogICAgYmFzZTY0X2J5dGVzID0gYmFzZTY0LmI2NGVuY29kZShkYXRhX2J5dGVzKQoKICAgIGlhbVJvbGUgPSBOb25lCiAgICBpZiAnQHNnZyhJQU1Sb2xlKScgIT0gJ05vbmUnOgogICAgICAgIGlhbVJvbGUgPSAnQHNnZyhJQU1Sb2xlKScKICAgIHRhZ3NbJ05hbWUnXSA9ICdzZy1hZ2VudCcKICAgIHJlcyA9IGxhdW5jaF9lYzJfaW5zdGFuY2UoJ0BzZ2coSW1hZ2VJZCknLCAnQHNnZyhLZXlOYW1lKScsICdAc2dnKEluc3RhbmNlVHlwZSknLCBAc2dnKFNlY3VyaXR5R3JvdXBJZHMpLCAnQHNnZyhTdWJuZXRJZCknLCAnQHNnZyhWcGNJZCknLCBjb3VudCwgY291bnQsIGJhc2U2NF9ieXRlcywgaWFtUm9sZSwgdGFncykKICAgIGlmIHJlc1swXToKICAgICAgICBwcmludCgnQHNnb3siZWMyX2luc3RhbmNlX2lkIjogIicgKyAnLCcuam9pbihyZXNbMV0pICsgJyJ9JykKICAgIGVsc2U6CiAgICAgICAgcHJpbnQoJ0ZhaWxlZCB0byBjcmVhdGUgZWMyIGluc3RhbmNlJykKICAgICAgICAKCnRhZ3MgPSBqc29uLmxvYWRzKCdAc2dnKCJ0YWdzIiknKQp0YWdzQXJyYXkgPSBbXQpmb3IgdCBpbiB0YWdzOgogICAgdGFnc0FycmF5LmFwcGVuZCh7J2tleSc6IHQsICd2YWx1ZSc6IHRhZ3NbdF19KQoKQ3JlYXRlRUMySW5zdGFuY2VzKHRhZ3MsIEBzZ2coTnVtSW5zdGFuY2VzKSkK","teamUsable":true,"teamEditable":false,"isActive":true},{"name":"ConfigureTerraform_AMZN_Linux_2.sh","scriptType":2,"code":"aWYgWyAiQHNnZygiVEVSUkFGT1JNX1ZFUlNJT04iKSIgIT0gIm51bGwiIF0KdGhlbgogICAgVEVSUkFGT1JNX1ZFUj0iQHNnZygiVEVSUkFGT1JNX1ZFUlNJT04iKSIKZWxzZQogICAgVEVSUkFGT1JNX1ZFUj1gY3VybCAtcyBodHRwczovL2FwaS5naXRodWIuY29tL3JlcG9zL2hhc2hpY29ycC90ZXJyYWZvcm0vcmVsZWFzZXMvbGF0ZXN0IHwgIGdyZXAgdGFnX25hbWUgfCBjdXQgLWQ6IC1mMiB8IHRyIC1kIFwiXCxcdiB8IGF3ayAneyQxPSQxfTsxJ2AKZmkKCndnZXQgaHR0cHM6Ly9yZWxlYXNlcy5oYXNoaWNvcnAuY29tL3RlcnJhZm9ybS8ke1RFUlJBRk9STV9WRVJ9L3RlcnJhZm9ybV8ke1RFUlJBRk9STV9WRVJ9X2xpbnV4X2FtZDY0LnppcAoKc3VkbyB5dW0gLXkgaW5zdGFsbCB1bnppcAp1bnppcCB0ZXJyYWZvcm1fJHtURVJSQUZPUk1fVkVSfV9saW51eF9hbWQ2NC56aXAKCnN1ZG8gbXYgdGVycmFmb3JtIC91c3IvbG9jYWwvYmluLwoK","teamUsable":true,"teamEditable":false,"isActive":true},{"name":"install git on ec2","scriptType":2,"code":"c3VkbyB5dW0gLXkgaW5zdGFsbCBnaXQ=","teamUsable":true,"teamEditable":false,"isActive":true},{"name":"InstallAWSSDK.sh","scriptType":2,"code":"Y3VybCAiaHR0cHM6Ly9hd3NjbGkuYW1hem9uYXdzLmNvbS9hd3NjbGktZXhlLWxpbnV4LXg4Nl82NC56aXAiIC1vICJhd3NjbGl2Mi56aXAiCnVuemlwIGF3c2NsaXYyLnppcApzdWRvIC4vYXdzL2luc3RhbGw=","teamUsable":true,"teamEditable":false,"isActive":true},{"name":"CreateSPABuildPipelineECRRepos.py","scriptType":0,"code":"aW1wb3J0IHN5cwoKQHNncygiZWNyX2FjY2Vzcy5weSIpCgpkZWYgY2FsbF9jcmVhdGVfcmVwb3NpdG9yeShuYW1lKToKICAgIHRyeToKICAgICAgICBjcmVhdGVfcmVwb3NpdG9yeShuYW1lKQogICAgZXhjZXB0IENsaWVudEVycm9yIGFzIGVycm9yOgogICAgICAgIGlmIGVycm9yLnJlc3BvbnNlWydFcnJvciddWydDb2RlJ10gPT0gJ1JlcG9zaXRvcnlBbHJlYWR5RXhpc3RzRXhjZXB0aW9uJzoKICAgICAgICAgICAgcHJpbnQoJ1JlcG8gJyArIG5hbWUgKyAnIGFscmVhZHkgZXhpc3RzJykKICAgICAgICBlbHNlOgogICAgICAgICAgICBwcmludCgnRXJyb3Igb2NjdXJyZWQgY3JlYXRpbmcgcmVwbyAnICsgbmFtZSArICc6ICcgKyBlcnJvci5yZXNwb25zZVsnRXJyb3InXVsnTWVzc2FnZSddKQogICAgICAgICAgICBzeXMuZXhpdCgxKQoKCmNhbGxfY3JlYXRlX3JlcG9zaXRvcnkoJ3NwYV9idWlsZF9waXBlbGluZV9hZ2VudF8xJykKY2FsbF9jcmVhdGVfcmVwb3NpdG9yeSgnc3BhX2J1aWxkX3BpcGVsaW5lX2FwaScpCmNhbGxfY3JlYXRlX3JlcG9zaXRvcnkoJ3NwYV9idWlsZF9waXBlbGluZV9jbGllbnQnKQpjYWxsX2NyZWF0ZV9yZXBvc2l0b3J5KCdzcGFfc3RvY2tfcXVvdGVfcHVibGlzaGVyJykK","teamUsable":true,"teamEditable":false,"isActive":true},{"name":"InstallBoto3.sh","scriptType":2,"code":"c3VkbyBwaXAgaW5zdGFsbCBib3RvMw==","teamUsable":true,"teamEditable":false,"isActive":true},{"name":"ecr_access.py","scriptType":0,"code":"aW1wb3J0IHN5cwppbXBvcnQgYm90bzMKZnJvbSBib3RvY29yZS5leGNlcHRpb25zIGltcG9ydCBDbGllbnRFcnJvcgpmcm9tIGJvdG9jb3JlLmV4Y2VwdGlvbnMgaW1wb3J0IFdhaXRlckVycm9yCgpzZXNzaW9uID0gYm90bzMuU2Vzc2lvbihhd3NfYWNjZXNzX2tleV9pZD0nQHNnZygiQVdTX0FDQ0VTU19LRVlfSUQiKScsIGF3c19zZWNyZXRfYWNjZXNzX2tleT0nQHNnZygiQVdTX1NFQ1JFVF9BQ0NFU1NfS0VZIiknKQplY3JfY2xpZW50ID0gYm90bzMuY2xpZW50KCdlY3InLCByZWdpb25fbmFtZT0nQHNnZygiQVdTX1JFR0lPTiIpJywgYXdzX2FjY2Vzc19rZXlfaWQ9J0BzZ2coIkFXU19BQ0NFU1NfS0VZX0lEIiknLCBhd3Nfc2VjcmV0X2FjY2Vzc19rZXk9J0BzZ2coIkFXU19TRUNSRVRfQUNDRVNTX0tFWSIpJykKCgpkZWYgY3JlYXRlX3JlcG9zaXRvcnkobmFtZSk6CiAgICByZXMgPSBlY3JfY2xpZW50LmNyZWF0ZV9yZXBvc2l0b3J5KHJlcG9zaXRvcnlOYW1lPW5hbWUpCiAgICBpZiAncmVwb3NpdG9yeScgaW4gcmVzIGFuZCAncmVwb3NpdG9yeVVyaScgaW4gcmVzWydyZXBvc2l0b3J5J106CiAgICAgICAgcHJpbnQoJ0BzZ297InJlcG9fdXJpIjogIicgKyByZXNbJ3JlcG9zaXRvcnknXVsncmVwb3NpdG9yeVVyaSddLnNwbGl0KCcvJylbMF0gKyAnIn0nKQogICAgZWxzZToKICAgICAgICByYWlzZSBDbGllbnRFcnJvcihyZXMpCiAgICAgICAg","teamUsable":true,"teamEditable":false,"isActive":true},{"name":"ec2_access.py","scriptType":0,"code":"aW1wb3J0IHN5cwppbXBvcnQgYm90bzMKZnJvbSBib3RvY29yZS5leGNlcHRpb25zIGltcG9ydCBDbGllbnRFcnJvcgpmcm9tIGJvdG9jb3JlLmV4Y2VwdGlvbnMgaW1wb3J0IFdhaXRlckVycm9yCmltcG9ydCByZXF1ZXN0cwppbXBvcnQgdGltZQoKc2Vzc2lvbiA9IGJvdG8zLlNlc3Npb24oYXdzX2FjY2Vzc19rZXlfaWQ9J0BzZ2coIkFXU19BQ0NFU1NfS0VZX0lEIiknLCBhd3Nfc2VjcmV0X2FjY2Vzc19rZXk9J0BzZ2coIkFXU19TRUNSRVRfQUNDRVNTX0tFWSIpJykKZWMyID0gc2Vzc2lvbi5yZXNvdXJjZSgnZWMyJykKZWMyX2NsaWVudCA9IGJvdG8zLmNsaWVudCgnZWMyJywgcmVnaW9uX25hbWU9J0BzZ2coIkFXU19SRUdJT04iKScsIGF3c19hY2Nlc3Nfa2V5X2lkPSdAc2dnKCJBV1NfQUNDRVNTX0tFWV9JRCIpJywgYXdzX3NlY3JldF9hY2Nlc3Nfa2V5PSdAc2dnKCJBV1NfU0VDUkVUX0FDQ0VTU19LRVkiKScpCgojIGxhdW5jaF9lYzJfaW5zdGFuY2UoJ2FtaS0wOTllODgyYjA4NzZjODEyNCcsICdraWtpLTIwMTlRMScsICd0MS5taWNybycsIFsnc2ctMDM2ZGUyNTM3YzA1OWE0YWYnXSwgJ3N1Ym5ldC1kNDdhMmJmYScsICd2cGMtZDJkM2I0YTgnKQoKZGVmIGxhdW5jaF9lYzJfaW5zdGFuY2UoYW1pX2lkLCBrZXlfcGFpcl9uYW1lLCBpbnN0YW5jZV90eXBlLCBzZWN1cml0eV9ncm91cF9pZHMsIHN1Ym5ldF9pZCwgdnBjPU5vbmUsIG1pbmNvdW50PTEsIG1heGNvdW50PTEsIHVzZXJfZGF0YT0nJywgaWFtX3JvbGU9Tm9uZSwgdGFncz1Ob25lKToKICAgIHByaW50KCdMYXVuY2hpbmcgYmV0d2VlbiB7fSBhbmQge30gZWMyIGluc3RhbmNlcyBvZiB0eXBlICJ7fSInLmZvcm1hdChtaW5jb3VudCwgbWF4Y291bnQsIGluc3RhbmNlX3R5cGUpKQoKICAgIHRhZ1NwZWNpZmljYXRpb25zID0gW10KICAgIGlmIG5vdCB0YWdzIGlzIE5vbmU6CiAgICAgICAgdGFnc0Zvcm1hdHRlZCA9IFtdCiAgICAgICAgZm9yIHQgaW4gdGFnczoKICAgICAgICAgICAgdGFnc0Zvcm1hdHRlZC5hcHBlbmQoeydLZXknOiB0LCAnVmFsdWUnOiB0YWdzW3RdfSkKICAgICAgICB0YWdTcGVjaWZpY2F0aW9ucy5hcHBlbmQoeydSZXNvdXJjZVR5cGUnOiAnaW5zdGFuY2UnLCAnVGFncyc6IHRhZ3NGb3JtYXR0ZWR9KQoKICAgIGluc3RhbmNlUHJvZmlsZSA9IHt9CiAgICBpZiBub3QgaWFtX3JvbGUgaXMgTm9uZToKICAgICAgICBpbnN0YW5jZVByb2ZpbGUgPSB7J0Fybic6ICcnLCAnTmFtZSc6IGlhbV9yb2xlfQoKICAgIGlmIG5vdCB2cGMgaXMgTm9uZToKICAgICAgICBlYzJjbGllbnQgPSBlYzIKICAgIGVsc2U6CiAgICAgICAgZWMyY2xpZW50ID0gZWMyLlN1Ym5ldCh2cGMpCiAgICBpbnN0YW5jZXMgPSBlYzJjbGllbnQuY3JlYXRlX2luc3RhbmNlcygKICAgICAgICBJbWFnZUlkPWFtaV9pZCwKICAgICAgICBNaW5Db3VudD1taW5jb3VudCwKICAgICAgICBNYXhDb3VudD1tYXhjb3VudCwKICAgICAgICBLZXlOYW1lPWtleV9wYWlyX25hbWUsCiAgICAgICAgU2VjdXJpdHlHcm91cElkcz1zZWN1cml0eV9ncm91cF9pZHMsCiAgICAgICAgVXNlckRhdGE9dXNlcl9kYXRhLAogICAgICAgIEluc3RhbmNlVHlwZT1pbnN0YW5jZV90eXBlLAogICAgICAgIFN1Ym5ldElkPXN1Ym5ldF9pZCwKICAgICAgICBUYWdTcGVjaWZpY2F0aW9ucz10YWdTcGVjaWZpY2F0aW9ucywKICAgICAgICBJYW1JbnN0YW5jZVByb2ZpbGU9aW5zdGFuY2VQcm9maWxlKQoKICAgIGlmIGluc3RhbmNlcyBpcyBOb25lOgogICAgICAgIHJldHVybiBGYWxzZSwgJ0Vycm9yIHJlc2VydmluZyBpbnN0YW5jZShzKScKCiAgICBpbnN0YW5jZXNfY3JlYXRlZCA9IFtdCiAgICBmb3IgaW5zdGFuY2UgaW4gaW5zdGFuY2VzOgogICAgICAgIHdoaWxlIFRydWU6CiAgICAgICAgICAgIHJlcyA9IGdldF9pbnN0YW5jZV9zdGF0dXMoaW5zdGFuY2UuaW5zdGFuY2VfaWQpCiAgICAgICAgICAgIGlmIGxlbihyZXNbJ0luc3RhbmNlU3RhdHVzZXMnXSkgPCAxOgogICAgICAgICAgICAgICAgcHJpbnQoJy4uLndhaXRpbmcgZm9yICJ7fSIgc3RhdHVzJy5mb3JtYXQoaW5zdGFuY2UuaW5zdGFuY2VfaWQpKQogICAgICAgICAgICAgICAgc3lzLnN0ZG91dC5mbHVzaCgpCiAgICAgICAgICAgICAgICB0aW1lLnNsZWVwKDEwKQogICAgICAgICAgICAgICAgY29udGludWUKICAgICAgICAgICAgc3RhdHVzID0gcmVzWydJbnN0YW5jZVN0YXR1c2VzJ11bMF0KICAgICAgICAgICAgaWYgc3RhdHVzWydJbnN0YW5jZVN0YXRlJ11bJ05hbWUnXSA9PSAncnVubmluZyc6CiAgICAgICAgICAgICAgICBwcmludCgnLi4uaW5zdGFuY2Uge30gaXMge30nLmZvcm1hdChpbnN0YW5jZS5pbnN0YW5jZV9pZCwgc3RhdHVzWydJbnN0YW5jZVN0YXRlJ11bJ05hbWUnXSkpCiAgICAgICAgICAgICAgICBzeXMuc3Rkb3V0LmZsdXNoKCkKICAgICAgICAgICAgICAgIHdoaWxlIFRydWU6CiAgICAgICAgICAgICAgICAgICAgcmVzID0gZ2V0X2luc3RhbmNlX3N0YXR1cyhpbnN0YW5jZS5pbnN0YW5jZV9pZCkKICAgICAgICAgICAgICAgICAgICBpZiBsZW4ocmVzWydJbnN0YW5jZVN0YXR1c2VzJ10pIDwgMToKICAgICAgICAgICAgICAgICAgICAgICAgY3VycmVudF9zdGF0ZSA9IGVjMl9jbGllbnQuZGVzY3JpYmVfaW5zdGFuY2VzKEluc3RhbmNlSWRzPVtpbnN0YW5jZS5pbnN0YW5jZV9pZF0pWydSZXNlcnZhdGlvbnMnXVswXVsnSW5zdGFuY2VzJ11bMF1bJ1N0YXRlJ11bJ05hbWUnXQogICAgICAgICAgICAgICAgICAgICAgICBjdXJyZW50X3N0YXRlX3JlYXNvbiA9IGVjMl9jbGllbnQuZGVzY3JpYmVfaW5zdGFuY2VzKEluc3RhbmNlSWRzPVtpbnN0YW5jZS5pbnN0YW5jZV9pZF0pWydSZXNlcnZhdGlvbnMnXVswXVsnSW5zdGFuY2VzJ11bMF1bJ1N0YXRlUmVhc29uJ11bJ01lc3NhZ2UnXQogICAgICAgICAgICAgICAgICAgICAgICBwcmludCgnLi4uaW5zdGFuY2Uge30gaXMge30gLSB7fScuZm9ybWF0KGluc3RhbmNlLmluc3RhbmNlX2lkLCBjdXJyZW50X3N0YXRlLCBjdXJyZW50X3N0YXRlX3JlYXNvbikpCiAgICAgICAgICAgICAgICAgICAgICAgIHN5cy5zdGRvdXQuZmx1c2goKQogICAgICAgICAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICAgICAgICAgIHN0YXR1cyA9IHJlc1snSW5zdGFuY2VTdGF0dXNlcyddWzBdCiAgICAgICAgICAgICAgICAgICAgaWYgc3RhdHVzWydJbnN0YW5jZVN0YXR1cyddWydTdGF0dXMnXSA9PSAnb2snOgogICAgICAgICAgICAgICAgICAgICAgICBpbnN0YW5jZXNfY3JlYXRlZC5hcHBlbmQoaW5zdGFuY2UuaW5zdGFuY2VfaWQpCiAgICAgICAgICAgICAgICAgICAgICAgIHByaW50KCcuLi5pbnN0YW5jZSB7fSBpcyB7fScuZm9ybWF0KGluc3RhbmNlLmluc3RhbmNlX2lkLCBzdGF0dXNbJ0luc3RhbmNlU3RhdHVzJ11bJ1N0YXR1cyddKSkKICAgICAgICAgICAgICAgICAgICAgICAgc3lzLnN0ZG91dC5mbHVzaCgpCiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgICAgICAgICAgZWxpZiBzdGF0dXNbJ0luc3RhbmNlU3RhdHVzJ11bJ1N0YXR1cyddID09ICdpbml0aWFsaXppbmcnOgogICAgICAgICAgICAgICAgICAgICAgICBpbnN0YW5jZXNfY3JlYXRlZC5hcHBlbmQoaW5zdGFuY2UuaW5zdGFuY2VfaWQpCiAgICAgICAgICAgICAgICAgICAgICAgIHByaW50KCcuLi5pbnN0YW5jZSB7fSBpcyB7fScuZm9ybWF0KGluc3RhbmNlLmluc3RhbmNlX2lkLCBzdGF0dXNbJ0luc3RhbmNlU3RhdHVzJ11bJ1N0YXR1cyddKSkKICAgICAgICAgICAgICAgICAgICAgICAgc3lzLnN0ZG91dC5mbHVzaCgpCiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICAgICAgcHJpbnQoJy4uLmluc3RhbmNlIHt9IGlzIHt9Jy5mb3JtYXQoaW5zdGFuY2UuaW5zdGFuY2VfaWQsIHN0YXR1c1snSW5zdGFuY2VTdGF0dXMnXVsnU3RhdHVzJ10pKQogICAgICAgICAgICAgICAgICAgICAgICBzeXMuc3Rkb3V0LmZsdXNoKCkKICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgIGVsaWYgc3RhdHVzWydJbnN0YW5jZVN0YXRlJ11bJ05hbWUnXSA9PSAncGVuZGluZyc6CiAgICAgICAgICAgICAgICBwcmludCgnLi4uaW5zdGFuY2Uge30gaXMge30nLmZvcm1hdChpbnN0YW5jZS5pbnN0YW5jZV9pZCwgc3RhdHVzWydJbnN0YW5jZVN0YXRlJ11bJ05hbWUnXSkpICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgIHN5cy5zdGRvdXQuZmx1c2goKQogICAgICAgICAgICAgICAgdGltZS5zbGVlcCgxMCkKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHByaW50KCcuLi5pbnN0YW5jZSB7fSBpcyB7fSAtIHt9Jy5mb3JtYXQoaW5zdGFuY2UuaW5zdGFuY2VfaWQsIHN0YXR1c1snSW5zdGFuY2VTdGF0ZSddWydOYW1lJ10sIGluc3RhbmNlLnN0YXRlX3JlYXNvbi5NZXNzYWdlKSkKICAgICAgICAgICAgICAgIHN5cy5zdGRvdXQuZmx1c2goKQogICAgICAgICAgICAgICAgYnJlYWsKCiAgICBpZiBsZW4oaW5zdGFuY2VzX2NyZWF0ZWQpID4gMDoKICAgICAgICBwcmludCgnTGF1bmNoZWQge30gZWMyIHt9IGluc3RhbmNlKHMpIFt7fV0nLmZvcm1hdChsZW4oaW5zdGFuY2VzX2NyZWF0ZWQpLCBpbnN0YW5jZV90eXBlLCAnLCcuam9pbihpbnN0YW5jZXNfY3JlYXRlZCkpKQogICAgICAgIHN5cy5zdGRvdXQuZmx1c2goKQogICAgICAgIHJldHVybiBUcnVlLCBpbnN0YW5jZXNfY3JlYXRlZAogICAgZWxzZToKICAgICAgICBwcmludCgnRmFpbGVkIHRvIGxhdW5jaCBhbnkgZWMyIGluc3RhbmNlcycpCiAgICAgICAgc3lzLnN0ZG91dC5mbHVzaCgpCiAgICAgICAgcmV0dXJuIEZhbHNlLCAnRmFpbGVkIHRvIGxhdW5jaCBhbnkgZWMyIGluc3RhbmNlcycKCgpkZWYgdGVybWluYXRlX2VjMl9pbnN0YW5jZXMoaW5zdGFuY2VzKToKICAgIHByaW50KCdUZXJtaW5hdGluZyBlYzIgaW5zdGFuY2VzIFt7MH1dJy5mb3JtYXQoJywnLmpvaW4oaW5zdGFuY2VzKSkpCiAgICBzeXMuc3Rkb3V0LmZsdXNoKCkKICAgIGVjMl9jbGllbnQudGVybWluYXRlX2luc3RhbmNlcyhJbnN0YW5jZUlkcz1pbnN0YW5jZXMpCiAgICB3YWl0ZXIgPSBlYzJfY2xpZW50LmdldF93YWl0ZXIoJ2luc3RhbmNlX3Rlcm1pbmF0ZWQnKQogICAgd2FpdGVyLndhaXQoSW5zdGFuY2VJZHM9aW5zdGFuY2VzKQogICAgcHJpbnQoJ2VjMiBpbnN0YW5jZXMgdGVybWluYXRlZCBbezB9XScuZm9ybWF0KCcsJy5qb2luKGluc3RhbmNlcykpKQogICAgc3lzLnN0ZG91dC5mbHVzaCgpCgoKZGVmIHN0YXJ0X2VjMl9pbnN0YW5jZXMoaW5zdGFuY2VzKToKICAgIHByaW50KCdTdGFydGluZyBlYzIgaW5zdGFuY2VzIFt7MH1dJy5mb3JtYXQoJywnLmpvaW4oaW5zdGFuY2VzKSkpCiAgICBzeXMuc3Rkb3V0LmZsdXNoKCkKICAgIGVjMl9jbGllbnQuc3RhcnRfaW5zdGFuY2VzKEluc3RhbmNlSWRzPWluc3RhbmNlcykKICAgIHdhaXRlciA9IGVjMl9jbGllbnQuZ2V0X3dhaXRlcignaW5zdGFuY2VfcnVubmluZycpCiAgICB3YWl0ZXIud2FpdChJbnN0YW5jZUlkcz1pbnN0YW5jZXMpCiAgICBwcmludCgnZWMyIGluc3RhbmNlcyBydW5uaW5nIFt7MH1dJy5mb3JtYXQoJywnLmpvaW4oaW5zdGFuY2VzKSkpCiAgICBzeXMuc3Rkb3V0LmZsdXNoKCkKCgpkZWYgc3RvcF9lYzJfaW5zdGFuY2VzKGluc3RhbmNlcyk6CiAgICBwcmludCgnU3RvcHBpbmcgZWMyIGluc3RhbmNlcyBbezB9XScuZm9ybWF0KCcsJy5qb2luKGluc3RhbmNlcykpKQogICAgc3lzLnN0ZG91dC5mbHVzaCgpCiAgICBlYzJfY2xpZW50LnN0b3BfaW5zdGFuY2VzKEluc3RhbmNlSWRzPWluc3RhbmNlcykKICAgIHdhaXRlciA9IGVjMl9jbGllbnQuZ2V0X3dhaXRlcignaW5zdGFuY2Vfc3RvcHBlZCcpCiAgICB3YWl0ZXIud2FpdChJbnN0YW5jZUlkcz1pbnN0YW5jZXMpCiAgICBwcmludCgnZWMyIGluc3RhbmNlcyBzdG9wcGVkIFt7MH1dJy5mb3JtYXQoJywnLmpvaW4oaW5zdGFuY2VzKSkpCiAgICBzeXMuc3Rkb3V0LmZsdXNoKCkKCgpkZWYgdGVybWluYXRlX2ltcGFpcmVkX2VjMl9pbnN0YW5jZXNfd2l0aF90YWdzKHRhZ3MpOgogICAgaW5zdGFuY2VfaWRzID0gZ2V0X2luc3RhbmNlX2lkc193aXRoX2ZpbHRlcih0YWdzLCBbJ3BlbmRpbmcnLCAncnVubmluZyddKQoKICAgIGltcGFpcmVkX2luc3RhbmNlcyA9IFtdCiAgICByZXMgPSBlYzJfY2xpZW50LmRlc2NyaWJlX2luc3RhbmNlX3N0YXR1cyhJbnN0YW5jZUlkcz1pbnN0YW5jZV9pZHMpCgogICAgZm9yIGluc3RhbmNlX3N0YXR1cyBpbiByZXNbJ0luc3RhbmNlU3RhdHVzZXMnXToKICAgICAgICBpZiBpbnN0YW5jZV9zdGF0dXNbJ0luc3RhbmNlU3RhdGUnXVsnTmFtZSddIGluIFsncGVuZGluZycsICdydW5uaW5nJ106CiAgICAgICAgICAgIGlmIGluc3RhbmNlX3N0YXR1c1snSW5zdGFuY2VTdGF0dXMnXVsnU3RhdHVzJ10gPT0gJ2ltcGFpcmVkJzoKICAgICAgICAgICAgICAgIGltcGFpcmVkX2luc3RhbmNlcy5hcHBlbmQoaW5zdGFuY2Vfc3RhdHVzWydJbnN0YW5jZUlkJ10pCgogICAgaWYgbGVuKGltcGFpcmVkX2luc3RhbmNlcykgPiAwOgogICAgICAgIHRlcm1pbmF0ZV9lYzJfaW5zdGFuY2VzKGltcGFpcmVkX2luc3RhbmNlcykKCiAgICByZXR1cm4gaW1wYWlyZWRfaW5zdGFuY2VzCgoKZGVmIGdldF9ydW5uaW5nX2luc3RhbmNlc193aXRoX3RhZ3ModGFncyk6CiAgICBpbnN0YW5jZV9pZHMgPSBnZXRfaW5zdGFuY2VfaWRzX3dpdGhfZmlsdGVyKHRhZ3MsIFsncGVuZGluZycsICdydW5uaW5nJ10pCiAgICBpZiBsZW4oaW5zdGFuY2VfaWRzKSA8IDE6CiAgICAgICAgcmV0dXJuIFtdCgogICAgcnVubmluZ19pbnN0YW5jZXMgPSBbXQogICAgcmVzID0gZWMyX2NsaWVudC5kZXNjcmliZV9pbnN0YW5jZV9zdGF0dXMoSW5zdGFuY2VJZHM9aW5zdGFuY2VfaWRzKQoKICAgIGZvciBpbnN0YW5jZV9zdGF0dXMgaW4gcmVzWydJbnN0YW5jZVN0YXR1c2VzJ106CiAgICAgICAgaWYgaW5zdGFuY2Vfc3RhdHVzWydJbnN0YW5jZVN0YXRlJ11bJ05hbWUnXSBpbiBbJ3BlbmRpbmcnLCAncnVubmluZyddOgogICAgICAgICAgICBpZiBpbnN0YW5jZV9zdGF0dXNbJ0luc3RhbmNlU3RhdHVzJ11bJ1N0YXR1cyddIGluIFsnb2snLCAnaW5pdGlhbGl6aW5nJ106CiAgICAgICAgICAgICAgICBydW5uaW5nX2luc3RhbmNlcy5hcHBlbmQoaW5zdGFuY2Vfc3RhdHVzWydJbnN0YW5jZUlkJ10pCgogICAgcmV0dXJuIHJ1bm5pbmdfaW5zdGFuY2VzCgoKIiIiCmFyZ3VtZW50czogc3RhdHVzID0gYXJyYXkgb2Ygc3RhdHVzZXMgdG8gaW5jbHVkZSwgZS5nLiBbJ3J1bm5pbmcnXQoiIiIKZGVmIGdldF9pbnN0YW5jZV9pZHNfd2l0aF9maWx0ZXIodGFncywgc3RhdHVzKToKICAgIGZpbHRlcnMgPSBbeydOYW1lJzogJ2luc3RhbmNlLXN0YXRlLW5hbWUnLCAnVmFsdWVzJzogc3RhdHVzfV0KICAgIGZvciB0IGluIHRhZ3M6CiAgICAgICAga2V5TmFtZSA9ICd0YWc6e30nLmZvcm1hdCh0KQogICAgICAgIGZpbHRlcnMuYXBwZW5kKHsnTmFtZSc6IGtleU5hbWUsICdWYWx1ZXMnOiBbdGFnc1t0XV19KQogICAgCiAgICByZXMgPSBlYzIuaW5zdGFuY2VzLmZpbHRlcihGaWx0ZXJzPWZpbHRlcnMpCgogICAgaW5zdGFuY2VfaWRzID0gW10KICAgIGZvciBpIGluIHJlczoKICAgICAgICBpbnN0YW5jZV9pZHMuYXBwZW5kKGkuaWQpCgogICAgcmV0dXJuIGluc3RhbmNlX2lkcwoKCmRlZiBnZXRfaW5zdGFuY2Vfc3RhdHVzKGluc3RhbmNlX2lkKToKICAgIHJldHVybiBlYzJfY2xpZW50LmRlc2NyaWJlX2luc3RhbmNlX3N0YXR1cyhJbnN0YW5jZUlkcz1baW5zdGFuY2VfaWRdKQoKCmRlZiBnZXRfaW5zdGFuY2UoaW5zdGFuY2VfaWQpOgogICAgcmV0dXJuIGVjMl9jbGllbnQuZGVzY3JpYmVfaW5zdGFuY2VzKEluc3RhbmNlSWRzPVtpbnN0YW5jZV9pZF0pCgoKZGVmIGdldF9ob3N0X2luc3RhbmNlX2lkKCk6CiAgICByZXNwb25zZSA9IHJlcXVlc3RzLmdldCgnaHR0cDovLzE2OS4yNTQuMTY5LjI1NC9sYXRlc3QvbWV0YS1kYXRhL2luc3RhbmNlLWlkJykKICAgIHJldHVybiByZXNwb25zZS50ZXh0CgoKZGVmIGdldF90YWdfdmFsdWUoaW5zdGFuY2VfaWQsIG5hbWUpOgogICAgdGFnX3ZhbHVlID0gTm9uZQogICAgaW5zdGFuY2UgPSBlYzIuSW5zdGFuY2UoaW5zdGFuY2VfaWQpCiAgICBmb3IgdGFnIGluIGluc3RhbmNlLnRhZ3M6CiAgICAgICAgaWYgdGFnWydLZXknXSA9PSBuYW1lOgogICAgICAgICAgICB0YWdfdmFsdWUgPSB0YWdbJ1ZhbHVlJ10KICAgICAgICAgICAgYnJlYWsKICAgIHJldHVybiB0YWdfdmFsdWUKCgpkZWYgZ2V0X251bV9ydW5uaW5nX3BlbmRpbmdfaW5zdGFuY2VzKHRhZ3MpOgogICAgZmlsdGVycyA9IFt7J05hbWUnOiAnaW5zdGFuY2Utc3RhdGUtbmFtZScsICdWYWx1ZXMnOiBbJ3J1bm5pbmcnLCAncGVuZGluZyddfV0KICAgIGZvciB0IGluIHRhZ3M6CiAgICAgICAga2V5TmFtZSA9ICd0YWc6e30nLmZvcm1hdCh0KQogICAgICAgIGZpbHRlcnMuYXBwZW5kKHsnTmFtZSc6IGtleU5hbWUsICdWYWx1ZXMnOiBbdGFnc1t0XV19KQoKICAgIGluc3RhbmNlcyA9IGVjMi5pbnN0YW5jZXMuZmlsdGVyKEZpbHRlcnM9ZmlsdGVycykKICAgIHJldHVybiBsZW4oaW5zdGFuY2VzKQogICAgIyBmb3IgaW5zdGFuY2UgaW4gaW5zdGFuY2VzOgogICAgIyAgICAgcHJpbnQoaW5zdGFuY2UuaWQsIGluc3RhbmNlLmluc3RhbmNlX3R5cGUpCg==","teamUsable":true,"teamEditable":true,"isActive":true}]}